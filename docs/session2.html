<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-01-12">

<title>Introduction to R and R modelling for Bioscience - 2. Working with Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./session3.html" rel="next">
<link href="./session1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Introduction to R and R modelling for Bioscience</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Kuan-Liu/Rworkshop"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">2. Working with Data</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">R Workshop for Bioscience</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session1.html" class="sidebar-item-text sidebar-link">1. Getting started with R</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session2.html" class="sidebar-item-text sidebar-link active">2. Working with Data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session3.html" class="sidebar-item-text sidebar-link">3. Statistical analysis in R</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-import-and-export" id="toc-data-import-and-export" class="nav-link active" data-scroll-target="#data-import-and-export">2.1 Data import and export</a>
  <ul class="collapse">
  <li><a href="#looking-at-the-data" id="toc-looking-at-the-data" class="nav-link" data-scroll-target="#looking-at-the-data">Looking at the data</a></li>
  <li><a href="#renaming-variables" id="toc-renaming-variables" class="nav-link" data-scroll-target="#renaming-variables">Renaming variables</a></li>
  <li><a href="#creating-new-variables" id="toc-creating-new-variables" class="nav-link" data-scroll-target="#creating-new-variables">Creating new variables</a></li>
  <li><a href="#subsetting-data" id="toc-subsetting-data" class="nav-link" data-scroll-target="#subsetting-data">Subsetting data</a></li>
  </ul></li>
  <li><a href="#data-manipulation-with-tidyverse-a-crush-introduction" id="toc-data-manipulation-with-tidyverse-a-crush-introduction" class="nav-link" data-scroll-target="#data-manipulation-with-tidyverse-a-crush-introduction">2.2 Data manipulation with tidyverse (a crush introduction)</a>
  <ul class="collapse">
  <li><a href="#selecting-columns" id="toc-selecting-columns" class="nav-link" data-scroll-target="#selecting-columns">Selecting Columns</a></li>
  <li><a href="#selecting-rows" id="toc-selecting-rows" class="nav-link" data-scroll-target="#selecting-rows">selecting rows</a></li>
  <li><a href="#creating-new-variables-1" id="toc-creating-new-variables-1" class="nav-link" data-scroll-target="#creating-new-variables-1">creating new variables</a></li>
  <li><a href="#grouping-and-summarizing-data" id="toc-grouping-and-summarizing-data" class="nav-link" data-scroll-target="#grouping-and-summarizing-data">Grouping and Summarizing Data</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns">Renaming columns</a></li>
  <li><a href="#reshaping-datasets---wide-vs-long-data" id="toc-reshaping-datasets---wide-vs-long-data" class="nav-link" data-scroll-target="#reshaping-datasets---wide-vs-long-data">Reshaping datasets - wide vs long data</a></li>
  <li><a href="#merging-data-frames" id="toc-merging-data-frames" class="nav-link" data-scroll-target="#merging-data-frames">Merging data frames</a></li>
  </ul></li>
  <li><a href="#data-visualization-with-ggplot2" id="toc-data-visualization-with-ggplot2" class="nav-link" data-scroll-target="#data-visualization-with-ggplot2">2.3 Data visualization with ggplot2</a>
  <ul class="collapse">
  <li><a href="#layers" id="toc-layers" class="nav-link" data-scroll-target="#layers">Layers</a></li>
  <li><a href="#geometry" id="toc-geometry" class="nav-link" data-scroll-target="#geometry">Geometry</a></li>
  <li><a href="#labs-axis-facet-and-theme" id="toc-labs-axis-facet-and-theme" class="nav-link" data-scroll-target="#labs-axis-facet-and-theme">labs, axis, facet, and theme</a></li>
  <li><a href="#adding-statistics" id="toc-adding-statistics" class="nav-link" data-scroll-target="#adding-statistics">adding statistics</a></li>
  <li><a href="#other-representative-plots" id="toc-other-representative-plots" class="nav-link" data-scroll-target="#other-representative-plots">Other representative plots</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">2. Working with Data</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023-01-12</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="callout-tip callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Loading, exploring and saving data</li>
<li>Learn to manipulate data frames with tidyverse</li>
<li>Overview of ggplot2 for data visualization</li>
</ul>
</div>
</div>
<ul>
<li><p>For this session, we will be working with the co2_mm_gl_clean.csv dataset</p></li>
<li><p>This data contains monthly globally averaged CO2 records between 1979 and 2022.</p></li>
<li><p>Lan, X., Tans, P. and K.W. Thoning: Trends in globally-averaged CO2 determined from NOAA Global Monitoring Laboratory measurements. Version 2023-01 NOAA/GML (<a href="https://gml.noaa.gov/ccgg/trends/" class="uri">https://gml.noaa.gov/ccgg/trends/</a>)</p></li>
</ul>
<section id="data-import-and-export" class="level2">
<h2 class="anchored" data-anchor-id="data-import-and-export">2.1 Data import and export</h2>
<ul>
<li>package <code>readr</code> reads txt, csv, Rdata (or rda).</li>
<li>package <code>haven</code> reads SPSS, Stata, and SAS files.</li>
<li>package <code>readxl</code> reads excel files (both .xls and .xlsx).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">fig.align=</span><span class="st">"center"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>, <span class="at">pillar.print_max =</span> <span class="cn">Inf</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>co2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"co2_mm_gl_clean.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="looking-at-the-data" class="level3">
<h3 class="anchored" data-anchor-id="looking-at-the-data">Looking at the data</h3>
<table class="table">
<thead>
<tr class="header">
<th>co2</th>
<th>Look at the whole data frame</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>head(co2)</td>
<td>Look at the first few rows</td>
</tr>
<tr class="even">
<td>tail(co2)</td>
<td>Look at the last few rows</td>
</tr>
<tr class="odd">
<td>colnames(co2)</td>
<td>Names of the columns in the data frame</td>
</tr>
<tr class="even">
<td>attributes(co2)</td>
<td>Attributes of the data frame</td>
</tr>
<tr class="odd">
<td>dim(co2)</td>
<td>Dimensions of the data frame</td>
</tr>
<tr class="even">
<td>ncol(co2)</td>
<td>Number of columns</td>
</tr>
<tr class="odd">
<td>nrow(co2)</td>
<td>Number of rows</td>
</tr>
<tr class="even">
<td>summary(co2)</td>
<td>Summary statistics</td>
</tr>
<tr class="odd">
<td>str(co2)</td>
<td>Structure of the data frame</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(co2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [526 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ year   : num [1:526] 1979 1979 1979 1979 1979 ...
 $ month  : num [1:526] 1 2 3 4 5 6 7 8 9 10 ...
 $ decimal: num [1:526] 1979 1979 1979 1979 1979 ...
 $ average: num [1:526] 337 337 338 338 338 ...
 $ stddev : num [1:526] 0.1 0.09 0.1 0.11 0.04 0.17 0.27 0.29 0.2 0.22 ...
 - attr(*, "spec")=
  .. cols(
  ..   year = col_double(),
  ..   month = col_double(),
  ..   decimal = col_double(),
  ..   average = col_double(),
  ..   stddev = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(co2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year          month           decimal        average     
 Min.   :1979   Min.   : 1.000   Min.   :1979   Min.   :334.4  
 1st Qu.:1989   1st Qu.: 3.250   1st Qu.:1990   1st Qu.:353.2  
 Median :2000   Median : 6.000   Median :2001   Median :369.7  
 Mean   :2000   Mean   : 6.481   Mean   :2001   Mean   :372.6  
 3rd Qu.:2011   3rd Qu.: 9.000   3rd Qu.:2012   3rd Qu.:391.3  
 Max.   :2022   Max.   :12.000   Max.   :2023   Max.   :418.5  
     stddev       
 Min.   :0.03000  
 1st Qu.:0.08000  
 Median :0.10000  
 Mean   :0.09894  
 3rd Qu.:0.11000  
 Max.   :0.29000  </code></pre>
</div>
</div>
</section>
<section id="renaming-variables" class="level3">
<h3 class="anchored" data-anchor-id="renaming-variables">Renaming variables</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(co2)[<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "stddev"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(co2)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">"sd"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(co2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "year"    "month"   "decimal" "average" "sd"     </code></pre>
</div>
</div>
</section>
<section id="creating-new-variables" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables">Creating new variables</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>co2<span class="sc">$</span>lowerbound_1sd <span class="ot">&lt;-</span> co2<span class="sc">$</span>average <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span>co2<span class="sc">$</span>sd</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>co2<span class="sc">$</span>upperbound_1sd <span class="ot">&lt;-</span> co2<span class="sc">$</span>average <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>co2<span class="sc">$</span>sd</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(co2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
   year month decimal average    sd lowerbound_1sd upperbound_1sd
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
1  1979     1   1979.    337.  0.1            336.           337.
2  1979     2   1979.    337.  0.09           337.           337.
3  1979     3   1979.    338.  0.1            338.           338.
4  1979     4   1979.    338.  0.11           338.           338.
5  1979     5   1979.    338.  0.04           338.           338.
6  1979     6   1979.    337.  0.17           337.           338.</code></pre>
</div>
</div>
</section>
<section id="subsetting-data" class="level3">
<h3 class="anchored" data-anchor-id="subsetting-data">Subsetting data</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting data between 2020 and 2022;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>co2_2020_2022 <span class="ot">&lt;-</span> <span class="fu">subset</span>(co2, year <span class="sc">&gt;=</span> <span class="dv">2020</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span><span class="dv">2022</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># subletting directly from dataframe using index;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># try at home;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># co2_2020_2022 &lt;- CO2[CO2year &gt;= 2020 &amp; year &lt;=2022, ]  # Select observations with year between 2020 and 2022;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>we can export data from r using write function</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(co2, <span class="at">file =</span> <span class="st">'co2_mm_gl_clean2.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-manipulation-with-tidyverse-a-crush-introduction" class="level2">
<h2 class="anchored" data-anchor-id="data-manipulation-with-tidyverse-a-crush-introduction">2.2 Data manipulation with tidyverse (a crush introduction)</h2>
<div class="callout-note callout callout-style-simple">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>What is the Tidyverse?</strong></p>
<p>The tidyverse consists of a few key packages: - <strong>dplyr: data manipulation</strong> - <strong>ggplot2: data visualization</strong> - <strong>tibble: tibbles, a modern re-imagining of data frames</strong> - tidyr: data tidying - readr: data import - purrr: functional programming, e.g.&nbsp;alternate approaches to apply</p>
</div>
</div>
</div>
<ul>
<li><p>Pipe operator <code>%&gt;%</code></p></li>
<li><p>Pipes are operators that send what comes before the pipe to what comes after.</p></li>
<li><p>frequently used in tidyverse!</p></li>
</ul>
<section id="selecting-columns" class="level3">
<h3 class="anchored" data-anchor-id="selecting-columns">Selecting Columns</h3>
<ul>
<li>Example: using <code>%&gt;%</code> to subset data
<ul>
<li><code>select()</code> in <code>dplyr</code> subset columns by names</li>
<li><code>filter()</code> subset rows using column values</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting columns;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, average) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># drop some variables;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>month) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sometimes, we have a lot of variables to select, and if they have a common naming scheme, this can be very easy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"bound"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Over helpful functions to be used within <code>select()</code>
<ul>
<li>starts_with: starts with a prefix</li>
<li>ends_with: ends with a suffix</li>
<li>contains: contains a literal string</li>
<li>matches: matches a regular expression</li>
<li>num_range: a numerical range like wk1, wk2, wk3.
<ul>
<li><code>select(num_range("wk", 1:3))</code></li>
</ul></li>
<li>everything: all variables.</li>
</ul></li>
</ul>
</section>
<section id="selecting-rows" class="level3">
<h3 class="anchored" data-anchor-id="selecting-rows">selecting rows</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting observations in year 2022;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, average) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
    year month average
   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1  2022     1    417.
 2  2022     2    418.
 3  2022     3    418.
 4  2022     4    418.
 5  2022     5    418.
 6  2022     6    417.
 7  2022     7    416.
 8  2022     8    414.
 9  2022     9    415.
10  2022    10    416.</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting observations between 2020 and 2022;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, average) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="dv">2022</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="dv">2020</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-new-variables-1" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables-1">creating new variables</h3>
<ul>
<li>Example: using <code>%&gt;%</code> and <code>mutate()</code> to create new variable</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lowerbound_2sd =</span> average <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>sd,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperbound_2sd =</span> average <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sd) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   year month decimal average    sd lowerbound_1sd upperbound_…¹ lower…² upper…³
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  1979     1   1979.    337.  0.1            336.          337.    336.    337.
2  1979     2   1979.    337.  0.09           337.          337.    337.    337.
3  1979     3   1979.    338.  0.1            338.          338.    338.    338.
4  1979     4   1979.    338.  0.11           338.          338.    338.    339.
5  1979     5   1979.    338.  0.04           338.          338.    338.    338.
6  1979     6   1979.    337.  0.17           337.          338.    337.    338.
# … with abbreviated variable names ¹​upperbound_1sd, ²​lowerbound_2sd,
#   ³​upperbound_2sd</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating new variables based on conditions of another variable;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># suppose we want to create a year group variable;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">&lt;</span> <span class="dv">1980</span> <span class="sc">~</span> <span class="st">'1970-1979'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1980</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">1990</span> <span class="sc">~</span> <span class="st">'1980-1989'</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1990</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">'1990-1999'</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2000</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2010</span> <span class="sc">~</span> <span class="st">'2000-2009'</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2010</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2020</span> <span class="sc">~</span> <span class="st">'2010-2019'</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2020</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2030</span> <span class="sc">~</span> <span class="st">'2020-2029'</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
   year month decimal average    sd lowerbound_1sd upperbound_1sd year_group
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;     
1  1979     1   1979.    337.  0.1            336.           337. 1970-1979 
2  1979     2   1979.    337.  0.09           337.           337. 1970-1979 
3  1979     3   1979.    338.  0.1            338.           338. 1970-1979 
4  1979     4   1979.    338.  0.11           338.           338. 1970-1979 
5  1979     5   1979.    338.  0.04           338.           338. 1970-1979 
6  1979     6   1979.    337.  0.17           337.           338. 1970-1979 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>co2 <span class="ot">&lt;-</span> co2 <span class="sc">%&gt;%</span> <span class="co">#updating the data object</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">&lt;</span> <span class="dv">1980</span> <span class="sc">~</span> <span class="st">'1970-1979'</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1980</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">1990</span> <span class="sc">~</span> <span class="st">'1980-1989'</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1990</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">'1990-1999'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2000</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2010</span> <span class="sc">~</span> <span class="st">'2000-2009'</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2010</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2020</span> <span class="sc">~</span> <span class="st">'2010-2019'</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2020</span> <span class="sc">&lt;=</span> year <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2030</span> <span class="sc">~</span> <span class="st">'2020-2029'</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grouping-and-summarizing-data" class="level3">
<h3 class="anchored" data-anchor-id="grouping-and-summarizing-data">Grouping and Summarizing Data</h3>
<ul>
<li><p>we can use <code>group_by()</code> and <code>summarize()</code> to help calculating group-based statistics</p></li>
<li><p>Example: suppose we want to calculate average, min, and max co2 by years (aggregated over month)</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, average) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">mean co2 by month</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(average),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">min co2 by month</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">min</span>(average),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">max co2 by month</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">max</span>(average)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
    year `mean co2 by month` `min co2 by month` `max co2 by month`
   &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;
 1  1979                337.               334.               338.
 2  1980                339.               337.               340.
 3  1981                340.               338.               342.
 4  1982                341.               338.               343.
 5  1983                343.               341.               344.
 6  1984                344.               342.               345.
 7  1985                346.               343.               347.
 8  1986                347.               345.               348.
 9  1987                349.               347.               350.
10  1988                351.               349.               352.
11  1989                353.               350.               354.
12  1990                354.               352.               356.
13  1991                355.               353.               357.
14  1992                356.               354.               358.
15  1993                357.               354.               358.
16  1994                358.               356.               360.
17  1995                360.               358.               362.
18  1996                362.               360.               363.
19  1997                363.               360.               365.
20  1998                366.               364.               367.
21  1999                368.               365.               369.
22  2000                369.               367.               370.
23  2001                371.               368.               372.
24  2002                373.               370.               374.
25  2003                375.               373.               377.
26  2004                377.               374.               378.
27  2005                379.               377.               381.
28  2006                381.               378.               383.
29  2007                383.               380.               384.
30  2008                385.               383.               387.
31  2009                386.               384.               388.
32  2010                389.               386.               390.
33  2011                391.               388.               392.
34  2012                393.               390.               394.
35  2013                395.               393.               397.
36  2014                397.               395.               399.
37  2015                400.               397.               402.
38  2016                403.               401.               405.
39  2017                405.               403.               407.
40  2018                408.               405.               409.
41  2019                410.               408.               412.
42  2020                412.               410.               414.
43  2021                415.               412.               417.
44  2022                417.               414.               418.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>we observe an increasing trend of global co2 concenration over years.</p>
</blockquote>
</section>
<section id="renaming-columns" class="level3">
<h3 class="anchored" data-anchor-id="renaming-columns">Renaming columns</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#example syntax;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">new_name =</span> oldname,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">new_name2 =</span> oldname2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reshaping-datasets---wide-vs-long-data" class="level3">
<h3 class="anchored" data-anchor-id="reshaping-datasets---wide-vs-long-data">Reshaping datasets - wide vs long data</h3>
<p><img src="pics/reshape.png" class="img-fluid" alt="R cheetsheet on reshaping data"> - pivot function has three argumnets:</p>
<p>The function requires the following arguments - a data frame (e.g.&nbsp;“wide”) - cols: name of the columns we wish to gather - names_to: name of the new column - values_to: name of the new column containing variable values</p>
<ul>
<li>suppose we want to reshape the long co2 data to wide data with month 1 to 12 as columns</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>co2_wide <span class="ot">&lt;-</span> co2 <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, average) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> month,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"mth"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> average)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(co2_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
   year  mth1  mth2  mth3  mth4  mth5  mth6  mth7  mth8  mth9 mth10 mth11 mth12
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  1979  337.  337.  338.  338.  338.  337.  336.  334.  335.  336.  337.  338.
2  1980  339.  339.  340.  340.  340.  340.  338.  337.  337.  338.  339.  340.
3  1981  340.  341.  341.  342.  341.  341.  339.  338.  338.  339.  340.  341.
4  1982  341.  342.  342.  343.  342.  341.  340.  338.  338.  340.  341.  342.
5  1983  342.  343.  343.  344.  344.  344.  342.  341.  341.  342.  343.  343.
6  1984  344.  345.  345.  345.  345.  345.  343.  342.  342.  343.  344.  345 </code></pre>
</div>
</div>
</section>
<section id="merging-data-frames" class="level3">
<h3 class="anchored" data-anchor-id="merging-data-frames">Merging data frames</h3>
<ul>
<li>we can also join two or multiple data frames together.
<ul>
<li>left_join()
<ul>
<li>keeps all the entries that are present in the left (first) table and excludes any that are only in the right table</li>
</ul></li>
<li>right_join()
<ul>
<li>keeps all the entries that are present in the right table and excludes any that are only in the left table.</li>
</ul></li>
<li>inner_join()
<ul>
<li>keeps only the entries that are present in both tables. inner_join is the only function that guarantees you won’t generate any missing entries.</li>
</ul></li>
<li>full_join()
<ul>
<li>keeps all of the entries in both tables, regardless of whether or not they appear in the other table.</li>
</ul></li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pics/dplyr-joins.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">R cheetsheet on merging data</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="data-visualization-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="data-visualization-with-ggplot2">2.3 Data visualization with ggplot2</h2>
<p><img src="pics/hex_ggplot.svg" class="img-fluid" style="width:20.0%"> &gt; Data visualization is key to data story telling.</p>
<ul>
<li>ggplot2 is a powerful package that enable publication ready plots
<ul>
<li>easy customization (over SAS)</li>
<li>clear syntax and lots of online template</li>
<li>lots of extensions on style</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pics/DL_datavis1_layers.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">How ggplot2 works, <a href="https://codeahoy.com/learn/rtutorial/ch8/" class="uri">https://codeahoy.com/learn/rtutorial/ch8/</a></figcaption><p></p>
</figure>
</div>
<div class="callout-tip callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
ggplot components (from Wickham, 2009)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>layer</strong> is a collection of geometric elements and statistical transformations.</p></li>
<li><p><strong>aesthetic(aes)</strong> is “something you can see”.</p>
<ul>
<li>x, y: variable along the x and y axis</li>
<li>colour: color of geoms according to data</li>
<li>fill: the inside color of the geom</li>
<li>group: what group a geom belongs to</li>
<li>shape: the figure used to plot a point</li>
<li>linetype: the type of line used (solid, dashed, etc)</li>
<li>size: size scaling for an extra dimension</li>
<li>alpha: the transparency of the geom</li>
</ul></li>
<li><p><strong>geometric elements (geoms)</strong>, represent what you actually see in the plot: points, lines, polygons, etc.</p>
<ul>
<li><code>geom_area()</code> draws an area plot</li>
<li><code>geom_bar(stat="identity")</code> draws a bar chart</li>
<li><code>geom_line()</code> draws a line</li>
<li><code>geom_point()</code> draws a scatterplot</li>
<li><code>geom_rect()</code>, draws rectangles</li>
</ul></li>
<li><p><strong>scales</strong> map values in the data space to values in the <strong>aesthetic</strong> space.</p>
<ul>
<li>This includes the use of colour, shape or size.</li>
<li>Scales also draw the legend and axes</li>
</ul></li>
<li><p><strong>coordinate(coord)</strong>, describes how data coordinates</p>
<ul>
<li>provides axes and gridlines to help read the graph.</li>
</ul></li>
<li><p><strong>facet</strong> specifies how to break up and display subsets of data as small multiples.</p></li>
<li><p><strong>theme</strong> controls display style, like the font size and background colour.</p></li>
</ul>
</div>
</div>
<section id="layers" class="level3">
<h3 class="anchored" data-anchor-id="layers">Layers</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> decimal, <span class="at">y =</span> average), <span class="at">data =</span> co2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="geometry" class="level3">
<h3 class="anchored" data-anchor-id="geometry">Geometry</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> decimal, <span class="at">y =</span> average), <span class="at">data =</span> co2)<span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>comparing to the plot provided on <a href="https://gml.noaa.gov/ccgg/trends/" class="uri">https://gml.noaa.gov/ccgg/trends/</a></li>
</ul>
<p><img src="pics/co2_trend_all_gl.png" class="img-fluid" style="width:60.0%"></p>
<div class="callout-caution callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand To Learn About various geoms
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>geom_abline: Reference lines: horizontal, vertical, and diagonal</li>
<li>geom_area: Ribbons and area plots</li>
<li>geom_bar: Bar charts</li>
<li>geom_boxplot: A box and whiskers plot</li>
<li>geom_contour: 2d contours of a 3d surface</li>
<li>geom_count: Count overlapping points</li>
<li>geom_crossbar: Vertical intervals: lines, crossbars &amp; errorbars</li>
<li>geom_curve: Line segments and curves</li>
<li>geom_density: Smoothed density estimates</li>
<li>geom_dotplot: Dot plot</li>
<li>geom_errorbar: Vertical intervals: lines, crossbars &amp; errorbars</li>
<li>geom_errorbarh: Horizontal error bars</li>
<li>geom_freqpoly: Histograms and frequency polygons</li>
<li>geom_hex: Hexagonal heatmap of 2d bin counts</li>
<li>geom_histogram: Histograms and frequency polygons</li>
<li>geom_hline: Reference lines: horizontal, vertical, and diagonal</li>
<li>geom_jitter: Jittered points</li>
<li>geom_label: Text</li>
<li>geom_line: Connect observations</li>
<li>geom_linerange: Vertical intervals: lines, crossbars &amp; errorbars</li>
<li>geom_map: Polygons from a reference map</li>
<li>geom_path: Connect observations</li>
<li>geom_pointrange: Vertical intervals: lines, crossbars &amp; errorbars</li>
<li>geom_polygon: Polygons</li>
<li>geom_qq: A quantile-quantile plot</li>
<li>geom_qq_line: A quantile-quantile plot</li>
<li>geom_quantile: Quantile regression</li>
<li>geom_raster: Rectangles</li>
<li>geom_ribbon: Ribbons and area plots</li>
<li>geom_rug: Rug plots in the margins</li>
<li>geom_segment: Line segments and curves</li>
<li>geom_smooth: Smoothed conditional means</li>
<li>geom_step: Connect observations</li>
<li>geom_text: Text</li>
<li>geom_tile: Rectangles</li>
<li>geom_violin: Violin plot</li>
<li>geom_vline: Reference lines: horizontal, vertical, and diagonal</li>
</ul>
</div>
</div>
</div>
</section>
<section id="labs-axis-facet-and-theme" class="level3">
<h3 class="anchored" data-anchor-id="labs-axis-facet-and-theme">labs, axis, facet, and theme</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average), <span class="at">data =</span> co2)<span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Month'</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'CO2 mole fraction (ppm)'</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Global Monthly Mean CO2'</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">300</span>,<span class="at">to=</span><span class="dv">450</span>,<span class="at">by=</span><span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year)) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adding-statistics" class="level3">
<h3 class="anchored" data-anchor-id="adding-statistics">adding statistics</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> average))<span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">bs</span>(x,<span class="dv">3</span>), <span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>, <span class="at">y =</span> <span class="st">'CO2 mole fraction (ppm)'</span>, <span class="at">title =</span> <span class="st">'Global Monthly Mean CO2 in 2021'</span>)<span class="sc">+</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
colours in R
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(RColorBrewer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: RColorBrewer</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="other-representative-plots" class="level3">
<h3 class="anchored" data-anchor-id="other-representative-plots">Other representative plots</h3>
<ul>
<li>Boxplot</li>
</ul>
<p>Suppose we want to look at CO2 distribution by year</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> co2, <span class="fu">aes</span>(<span class="at">x=</span>year_group, <span class="at">y=</span>average, <span class="at">fill=</span>year_group)) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Reds"</span>)<span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Year Group'</span>, </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'CO2 mole fraction (ppm)'</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Global Monthly Mean CO2 by Year Group'</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">'Year group'</span>)<span class="sc">+</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Heatmaps</p></li>
<li><p>we are interested to look at the pattern of CO2 concentration by year and month</p></li>
<li><p>three data dimensions: year, month, and value of co2</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> co2, <span class="fu">aes</span>(<span class="at">y=</span><span class="fu">factor</span>(year), <span class="at">x=</span><span class="fu">factor</span>(month), <span class="at">fill=</span>average)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Reds"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Month'</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Year'</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Global Monthly Mean CO2'</span>)<span class="sc">+</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The R Graph Gallery, <a href="https://r-graph-gallery.com/index.html" class="uri">https://r-graph-gallery.com/index.html</a></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pics/rplot_gallery.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Best reference for plotting with ggplot2 in R, <a href="https://r-graph-gallery.com/index.html" class="uri">https://r-graph-gallery.com/index.html</a></figcaption><p></p>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./session1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">1. Getting started with R</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./session3.html" class="pagination-link">
        <span class="nav-page-text">3. Statistical analysis in R</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://www.kuan-liu.com">Kuan Liu</a>, University of Toronto @ 2023</div>   
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>